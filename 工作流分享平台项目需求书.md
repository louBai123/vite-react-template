# 工作流分享平台项目需求书

## 项目概述

### 项目背景
工作流分享平台是一个基于Web的多角色在线平台，旨在为创作者提供工作流分享和变现的渠道，为用户提供高质量的工作流资源，为广告商提供精准的营销平台。平台支持创作者、普通用户、广告商和管理员四种角色，采用前后端分离架构，提供响应式Web界面和完善的管理后台。

### 项目目标
- 构建一个稳定、安全、高性能的工作流分享平台
- 实现多角色用户管理和权限控制
- 提供完善的工作流上传、审核、分发机制
- 建立公平的收益分成体系
- 打造智能的内容推荐和搜索系统
- 集成多种支付方式和广告投放功能

### 核心价值
- **创作者价值**：通过工作流分享获得收益，激励优质内容创作
- **用户价值**：获取高质量工作流，提升工作效率
- **平台价值**：通过交易分成和广告收入实现商业化
- **广告商价值**：精准投放广告，提升营销效果

## 技术架构

### 技术栈选择

#### 前端技术栈
- **框架**：React 18 + TypeScript
- **UI组件库**：Ant Design / Material-UI
- **路由管理**：React Router
- **状态管理**：Redux Toolkit
- **HTTP客户端**：Axios
- **构建工具**：Webpack
- **代码规范**：ESLint + Prettier
- **测试框架**：Jest + React Testing Library + Cypress

#### 后端技术栈
- **运行环境**：Node.js + Express.js（备选：Java Spring Boot）
- **主数据库**：MySQL 8.0+
- **缓存系统**：Redis 6.0+
- **文档存储**：MongoDB（工作流元数据）
- **搜索引擎**：Elasticsearch
- **身份认证**：JWT + Passport.js
- **文件处理**：Multer + Sharp
- **任务队列**：Bull Queue
- **API文档**：Swagger/OpenAPI

#### 基础设施
- **云服务商**：阿里云/腾讯云
- **对象存储**：OSS（工作流文件存储）
- **CDN**：内容分发网络
- **负载均衡**：SLB
- **数据库**：RDS云数据库
- **监控告警**：云监控 + 自定义监控
- **日志系统**：ELK Stack

### 系统架构图

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   用户前端      │    │   管理后台      │    │   广告商后台    │
│   (React)       │    │   (React)       │    │   (React)       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────────────────────┼───────────────────────┘
                                 │
                    ┌─────────────────┐
                    │   API Gateway   │
                    │   (Nginx)       │
                    └─────────────────┘
                                 │
                    ┌─────────────────┐
                    │   应用服务器    │
                    │   (Node.js)     │
                    └─────────────────┘
                                 │
         ┌───────────────────────┼───────────────────────┐
         │                       │                       │
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   MySQL         │    │   Redis         │    │   MongoDB       │
│   (主数据库)    │    │   (缓存)        │    │   (文档存储)    │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 前端页面设计

### 用户前端页面结构

#### 1. 首页 (/)
**页面布局：**
```
┌─────────────────────────────────────────────────────────────┐
│                        导航栏                               │
│  Logo  [搜索框]  分类  排行榜  登录/用户头像                │
├─────────────────────────────────────────────────────────────┤
│                      轮播广告区                             │
│              [广告1] [广告2] [广告3]                        │
├─────────────────────────────────────────────────────────────┤
│  热门分类                                                   │
│  [办公自动化] [数据处理] [设计创作] [营销推广] [开发工具]   │
├─────────────────────────────────────────────────────────────┤
│  推荐工作流                                                 │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │工作流1  │ │工作流2  │ │工作流3  │ │工作流4  │           │
│  │预览图   │ │预览图   │ │预览图   │ │预览图   │           │
│  │标题     │ │标题     │ │标题     │ │标题     │           │
│  │价格/免费│ │价格/免费│ │价格/免费│ │价格/免费│           │
│  │评分★★★ │ │评分★★★ │ │评分★★★ │ │评分★★★ │           │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
├─────────────────────────────────────────────────────────────┤
│  本周热门 | 最新上传 | 评分最高                            │
│  [更多工作流卡片...]                                        │
└─────────────────────────────────────────────────────────────┘
```

**功能组件：**
- 响应式导航栏（Logo、搜索、分类菜单、用户菜单）
- 轮播广告组件
- 分类快捷入口
- 工作流卡片组件（预览图、标题、价格、评分、标签）
- 分页加载组件

#### 2. 工作流详情页 (/workflow/:id)
**页面布局：**
```
┌─────────────────────────────────────────────────────────────┐
│                        导航栏                               │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────────────────────────┐│
│  │                 │  │  工作流标题                         ││
│  │   预览图轮播    │  │  创作者：[头像] 用户名              ││
│  │                 │  │  分类：办公自动化 > 表格处理        ││
│  │  [图1][图2][图3]│  │  价格：¥29.9 / 免费                ││
│  │                 │  │  评分：★★★★☆ (4.2) 123人评价      ││
│  └─────────────────┘  │  下载：1,234次                      ││
│                        │  ┌─────────┐ ┌─────────┐           ││
│                        │  │立即购买 │ │收藏     │           ││
│                        │  └─────────┘ └─────────┘           ││
│                        └─────────────────────────────────────┘│
├─────────────────────────────────────────────────────────────┤
│  标签页：[详细介绍] [使用说明] [评价(123)] [相关推荐]       │
├─────────────────────────────────────────────────────────────┤
│  内容区域（根据选中标签页显示不同内容）                     │
│  - 详细介绍：工作流功能描述、适用场景、使用效果             │
│  - 使用说明：安装步骤、操作指南、注意事项                   │
│  - 评价：用户评价列表、评分统计、评价筛选                   │
│  - 相关推荐：同类工作流、同作者作品                         │
└─────────────────────────────────────────────────────────────┘
```

#### 3. 分类页面 (/category/:id)
**页面布局：**
```
┌─────────────────────────────────────────────────────────────┐
│                        导航栏                               │
├─────────────────────────────────────────────────────────────┤
│  面包屑导航：首页 > 办公自动化 > 表格处理                   │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────────────────────────┐│
│  │   筛选侧边栏    │  │           工作流列表                ││
│  │                 │  │                                     ││
│  │ 价格范围        │  │  排序：[最新] [热门] [价格] [评分]  ││
│  │ ○ 免费          │  │                                     ││
│  │ ○ ¥1-10         │  │  ┌─────────────────────────────────┐││
│  │ ○ ¥10-50        │  │  │ 工作流卡片1                     │││
│  │ ○ ¥50+          │  │  │ [预览图] 标题 价格 评分 下载量  │││
│  │                 │  │  └─────────────────────────────────┘││
│  │ 评分            │  │  ┌─────────────────────────────────┐││
│  │ ○ 5星           │  │  │ 工作流卡片2                     │││
│  │ ○ 4星以上       │  │  └─────────────────────────────────┘││
│  │ ○ 3星以上       │  │  [更多工作流...]                    ││
│  │                 │  │                                     ││
│  │ 标签            │  │  ┌─────────────────────────────────┐││
│  │ ☑ Excel         │  │  │         分页组件                ││
│  │ ☑ 自动化        │  │  │    [1] [2] [3] ... [10] [下一页] ││
│  │ ☐ 报表          │  │  └─────────────────────────────────┘││
│  └─────────────────┘  └─────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

#### 4. 用户个人中心 (/profile)
**页面布局：**
```
┌─────────────────────────────────────────────────────────────┐
│                        导航栏                               │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────────────────────────┐│
│  │   侧边菜单      │  │           主内容区                  ││
│  │                 │  │                                     ││
│  │ ● 个人信息      │  │  个人信息编辑表单                   ││
│  │ ○ 我的购买      │  │  ┌─────────────────────────────────┐││
│  │ ○ 我的收藏      │  │  │ 头像上传                        │││
│  │ ○ 充值记录      │  │  │ 用户名：[输入框]                │││
│  │ ○ 消费记录      │  │  │ 邮箱：[输入框]                  │││
│  │ ○ 创作中心      │  │  │ 个人简介：[文本框]              │││
│  │ ○ 收益统计      │  │  │ ┌─────────┐                     │││
│  │ ○ 账户设置      │  │  │ │保存修改 │                     │││
│  │                 │  │  │ └─────────┘                     │││
│  └─────────────────┘  │  └─────────────────────────────────┘││
│                        └─────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

#### 5. 创作者中心 (/creator)
**页面布局：**
```
┌─────────────────────────────────────────────────────────────┐
│                        导航栏                               │
├─────────────────────────────────────────────────────────────┤
│  数据概览卡片                                               │
│  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │
│  │总收益   │ │本月收益 │ │作品数量 │ │总下载量 │           │
│  │¥1,234   │ │¥234     │ │12个     │ │5,678次  │           │
│  └─────────┘ └─────────┘ └─────────┘ └─────────┘           │
├─────────────────────────────────────────────────────────────┤
│  操作按钮区                                                 │
│  ┌─────────────┐ ┌─────────────┐                           │
│  │上传新工作流 │ │收益提现     │                           │
│  └─────────────┘ └─────────────┘                           │
├─────────────────────────────────────────────────────────────┤
│  我的作品列表                                               │
│  ┌─────────────────────────────────────────────────────────┐│
│  │ 工作流1  │ 状态：已上架 │ 下载：123次 │ 收益：¥45.6    ││
│  │ [编辑] [下架] [查看统计]                                ││
│  └─────────────────────────────────────────────────────────┘│
│  ┌─────────────────────────────────────────────────────────┐│
│  │ 工作流2  │ 状态：审核中 │ 下载：0次   │ 收益：¥0       ││
│  │ [编辑] [删除]                                           ││
│  └─────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

### 管理后台页面设计

#### 1. 管理后台首页 (/admin)
**页面布局：**
```
┌─────────────────────────────────────────────────────────────┐
│  ┌─────────────────┐  ┌─────────────────────────────────────┐│
│  │                 │  │           顶部导航栏                ││
│  │                 │  │  工作流分享平台管理后台  [用户头像] ││
│  │                 │  └─────────────────────────────────────┘│
│  │   左侧菜单      │  ┌─────────────────────────────────────┐│
│  │                 │  │           数据概览                  ││
│  │ ● 仪表盘        │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐││
│  │ ○ 用户管理      │  │  │总用户数 │ │活跃用户 │ │新增用户 │││
│  │ ○ 工作流管理    │  │  │12,345   │ │3,456    │ │234      │││
│  │ ○ 交易管理      │  │  └─────────┘ └─────────┘ └─────────┘││
│  │ ○ 广告管理      │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐││
│  │ ○ 财务统计      │  │  │总工作流 │ │待审核   │ │今日下载 │││
│  │ ○ 系统设置      │  │  │1,234个  │ │56个     │ │789次    │││
│  │ ○ 操作日志      │  │  └─────────┘ └─────────┘ └─────────┘││
│  │                 │  └─────────────────────────────────────┘│
│  │                 │  ┌─────────────────────────────────────┐│
│  │                 │  │           图表区域                  ││
│  │                 │  │  用户增长趋势图                     ││
│  │                 │  │  收入统计图                         ││
│  │                 │  │  热门分类分布图                     ││
│  │                 │  └─────────────────────────────────────┘│
│  └─────────────────┘                                        │
└─────────────────────────────────────────────────────────────┘
```

#### 2. 用户管理页面 (/admin/users)
**页面布局：**
```
┌─────────────────────────────────────────────────────────────┐
│  左侧菜单 │                 用户管理                         │
│          ├─────────────────────────────────────────────────┤
│          │  搜索筛选区                                     │
│          │  [搜索框] [角色筛选] [状态筛选] [注册时间筛选]   │
│          ├─────────────────────────────────────────────────┤
│          │  用户列表表格                                   │
│          │  ┌─────────────────────────────────────────────┐│
│          │  │ID│用户名│邮箱│角色│余额│状态│注册时间│操作  ││
│          │  ├─────────────────────────────────────────────┤│
│          │  │1 │张三  │xxx │用户│¥100│正常│2024-01-01│... ││
│          │  │2 │李四  │xxx │创作│¥200│正常│2024-01-02│... ││
│          │  │3 │王五  │xxx │用户│¥50 │冻结│2024-01-03│... ││
│          │  └─────────────────────────────────────────────┘│
│          │  操作按钮：[查看详情] [编辑] [重置密码] [冻结]   │
│          │  分页：[上一页] [1] [2] [3] ... [下一页]        │
└─────────────────────────────────────────────────────────────┘
```

#### 3. 工作流管理页面 (/admin/workflows)
**页面布局：**
```
┌─────────────────────────────────────────────────────────────┐
│  左侧菜单 │                工作流管理                        │
│          ├─────────────────────────────────────────────────┤
│          │  搜索筛选区                                     │
│          │  [搜索框] [分类筛选] [状态筛选] [创建时间筛选]   │
│          ├─────────────────────────────────────────────────┤
│          │  工作流列表表格                                 │
│          │  ┌─────────────────────────────────────────────┐│
│          │  │ID│标题│创作者│分类│价格│状态│创建时间│操作  ││
│          │  ├─────────────────────────────────────────────┤│
│          │  │1 │Excel自动化│张三│办公│¥29.9│已上架│...│... ││
│          │  │2 │数据分析  │李四│数据│免费 │待审核│...│... ││
│          │  │3 │图像处理  │王五│设计│¥19.9│已拒绝│...│... ││
│          │  └─────────────────────────────────────────────┘│
│          │  操作按钮：[查看详情] [审核] [下架] [删除]       │
│          │  分页：[上一页] [1] [2] [3] ... [下一页]        │
└─────────────────────────────────────────────────────────────┘
```

### 广告商后台页面设计

#### 1. 广告商后台首页 (/advertiser)
**页面布局：**
```
┌─────────────────────────────────────────────────────────────┐
│                        顶部导航栏                           │
│  广告投放管理平台  [账户余额：¥1,000] [用户头像]           │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────────────────────────┐│
│  │   左侧菜单      │  │           数据概览                  ││
│  │                 │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐││
│  │ ● 仪表盘        │  │  │总消费   │ │今日消费 │ │活跃广告 │││
│  │ ○ 广告管理      │  │  │¥5,678   │ │¥234     │ │3个      │││
│  │ ○ 创建广告      │  │  └─────────┘ └─────────┘ └─────────┘││
│  │ ○ 数据报表      │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐││
│  │ ○ 账户充值      │  │  │总展示   │ │总点击   │ │点击率   │││
│  │ ○ 财务记录      │  │  │12,345次 │ │1,234次  │ │10.0%    │││
│  │                 │  │  └─────────┘ └─────────┘ └─────────┘││
│  └─────────────────┘  └─────────────────────────────────────┘│
│                        ┌─────────────────────────────────────┐│
│                        │           图表区域                  ││
│                        │  广告效果趋势图                     ││
│                        │  消费统计图                         ││
│                        │  点击率分析图                       ││
│                        └─────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
```

### 通用组件设计

#### 1. 工作流卡片组件 (WorkflowCard)
```
┌─────────────────────────────────────┐
│              预览图                 │
│         [200x150px]                 │
├─────────────────────────────────────┤
│ 工作流标题（最多2行）               │
│ 创作者：用户名                      │
│ 分类：办公自动化                    │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ │
│ │¥29.9    │ │★4.5     │ │下载1.2k │ │
│ └─────────┘ └─────────┘ └─────────┘ │
│ [标签1] [标签2] [标签3]             │
└─────────────────────────────────────┘
```

#### 2. 搜索框组件 (SearchBox)
```
┌─────────────────────────────────────────────────────────────┐
│ [🔍] 搜索工作流、创作者...          [高级搜索] [搜索]      │
└─────────────────────────────────────────────────────────────┘
```

#### 3. 分页组件 (Pagination)
```
┌─────────────────────────────────────────────────────────────┐
│ 共123条记录，每页20条                                       │
│ [首页] [上一页] [1] [2] [3] ... [10] [下一页] [末页]       │
│ 跳转到 [输入框] 页                                          │
└─────────────────────────────────────────────────────────────┘
```

#### 4. 工作流上传组件 (WorkflowUpload)
```
┌─────────────────────────────────────────────────────────────┐
│ 基本信息                                                    │
│ 标题：[输入框]                                              │
│ 描述：[文本框]                                              │
│ 分类：[下拉选择] 子分类：[下拉选择]                         │
│ 标签：[标签输入框]                                          │
│ 价格：○免费 ○付费 [价格输入框]                             │
├─────────────────────────────────────────────────────────────┤
│ 文件上传                                                    │
│ 工作流文件：[拖拽上传区域] 支持.json, .workflow等格式       │
│ 预览图片：[图片上传区域] 最多5张，建议尺寸800x600          │
├─────────────────────────────────────────────────────────────┤
│ 使用说明                                                    │
│ [富文本编辑器]                                              │
├─────────────────────────────────────────────────────────────┤
│ [保存草稿] [预览] [提交审核]                                │
└─────────────────────────────────────────────────────────────┘
```

#### 5. 支付弹窗组件 (PaymentModal)
```
┌─────────────────────────────────────────────────────────────┐
│                        支付确认                             │
├─────────────────────────────────────────────────────────────┤
│ 商品：Excel数据处理工作流                                   │
│ 价格：¥29.90                                               │
│ 优惠：-¥5.00（新用户优惠）                                  │
│ 实付：¥24.90                                               │
├─────────────────────────────────────────────────────────────┤
│ 支付方式：                                                  │
│ ○ 余额支付（余额：¥100.00）                                │
│ ○ 支付宝                                                   │
│ ○ 微信支付                                                 │
│ ○ 银行卡                                                   │
├─────────────────────────────────────────────────────────────┤
│ [取消] [确认支付]                                           │
└─────────────────────────────────────────────────────────────┘
```

## 数据库设计

### 核心数据表结构

#### 用户表 (users)
```sql
CREATE TABLE users (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role ENUM('user', 'creator', 'admin', 'advertiser') DEFAULT 'user',
    avatar_url VARCHAR(255),
    balance DECIMAL(10,2) DEFAULT 0.00,
    total_earnings DECIMAL(10,2) DEFAULT 0.00,
    status ENUM('active', 'suspended', 'deleted') DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_username (username),
    INDEX idx_email (email),
    INDEX idx_role (role),
    INDEX idx_status (status)
);
```

#### 工作流表 (workflows)
```sql
CREATE TABLE workflows (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    creator_id BIGINT NOT NULL,
    title VARCHAR(200) NOT NULL,
    description TEXT,
    category_id INT NOT NULL,
    subcategory_id INT,
    price DECIMAL(8,2) DEFAULT 0.00,
    file_url VARCHAR(500) NOT NULL,
    preview_images JSON,
    tags JSON,
    download_count INT DEFAULT 0,
    rating DECIMAL(3,2) DEFAULT 0.00,
    rating_count INT DEFAULT 0,
    favorite_count INT DEFAULT 0,
    comment_count INT DEFAULT 0,
    status ENUM('pending', 'approved', 'rejected', 'offline') DEFAULT 'pending',
    is_featured BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (creator_id) REFERENCES users(id),
    INDEX idx_creator (creator_id),
    INDEX idx_category (category_id),
    INDEX idx_status (status),
    INDEX idx_featured (is_featured),
    INDEX idx_rating (rating),
    INDEX idx_downloads (download_count)
);
```

#### 分类表 (categories)
```sql
CREATE TABLE categories (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    parent_id INT DEFAULT NULL,
    description TEXT,
    icon_url VARCHAR(255),
    sort_order INT DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    FOREIGN KEY (parent_id) REFERENCES categories(id),
    INDEX idx_parent (parent_id),
    INDEX idx_active (is_active)
);
```

#### 交易记录表 (transactions)
```sql
CREATE TABLE transactions (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    workflow_id BIGINT,
    type ENUM('purchase', 'recharge', 'withdrawal', 'commission') NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    status ENUM('pending', 'completed', 'failed', 'refunded') DEFAULT 'pending',
    payment_method VARCHAR(50),
    payment_id VARCHAR(100),
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (workflow_id) REFERENCES workflows(id),
    INDEX idx_user (user_id),
    INDEX idx_workflow (workflow_id),
    INDEX idx_type (type),
    INDEX idx_status (status),
    INDEX idx_created (created_at)
);
```

#### 用户工作流关系表 (user_workflows)
```sql
CREATE TABLE user_workflows (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    workflow_id BIGINT NOT NULL,
    action ENUM('purchase', 'favorite', 'download') NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (workflow_id) REFERENCES workflows(id),
    UNIQUE KEY uk_user_workflow_action (user_id, workflow_id, action),
    INDEX idx_user (user_id),
    INDEX idx_workflow (workflow_id)
);
```

#### 评价表 (reviews)
```sql
CREATE TABLE reviews (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    user_id BIGINT NOT NULL,
    workflow_id BIGINT NOT NULL,
    rating TINYINT NOT NULL CHECK (rating >= 1 AND rating <= 5),
    comment TEXT,
    status ENUM('active', 'hidden', 'deleted') DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id),
    FOREIGN KEY (workflow_id) REFERENCES workflows(id),
    UNIQUE KEY uk_user_workflow (user_id, workflow_id),
    INDEX idx_workflow (workflow_id),
    INDEX idx_rating (rating)
);
```

#### 广告表 (advertisements)
```sql
CREATE TABLE advertisements (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    advertiser_id BIGINT NOT NULL,
    title VARCHAR(200) NOT NULL,
    content TEXT,
    image_url VARCHAR(500),
    target_url VARCHAR(500),
    position ENUM('banner', 'sidebar', 'detail', 'search') NOT NULL,
    budget DECIMAL(10,2) NOT NULL,
    spent DECIMAL(10,2) DEFAULT 0.00,
    impressions INT DEFAULT 0,
    clicks INT DEFAULT 0,
    status ENUM('pending', 'active', 'paused', 'completed') DEFAULT 'pending',
    start_date DATE,
    end_date DATE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (advertiser_id) REFERENCES users(id),
    INDEX idx_advertiser (advertiser_id),
    INDEX idx_status (status),
    INDEX idx_position (position)
);
```

## 功能需求详述

### 1. 用户管理系统

#### 1.1 用户注册与登录
- **注册功能**：支持邮箱注册，包含邮箱验证
- **登录功能**：支持用户名/邮箱登录，记住登录状态
- **密码管理**：密码加密存储，支持密码重置
- **角色选择**：注册时选择用户角色（普通用户/创作者/广告商）
- **第三方登录**：支持微信、QQ等第三方登录（可选）

#### 1.2 用户权限管理
- **角色权限**：
  - 普通用户：浏览、购买、评价工作流
  - 创作者：上传、管理工作流，查看收益
  - 广告商：创建、管理广告投放
  - 管理员：平台管理、用户管理、内容审核
- **权限验证**：API级别的权限验证
- **角色升级**：普通用户可申请成为创作者

#### 1.3 用户个人中心
- **基本信息管理**：头像、昵称、邮箱、个人简介
- **账户管理**：余额查询、充值记录、消费记录
- **安全设置**：密码修改、登录设备管理
- **偏好设置**：通知设置、隐私设置

### 2. 工作流管理系统

#### 2.1 工作流上传与编辑
- **文件上传**：支持多种工作流格式，文件大小限制
- **信息填写**：标题、描述、分类、标签、价格设置
- **预览图片**：支持多张预览图上传
- **版本管理**：支持工作流版本更新
- **草稿保存**：支持保存草稿，稍后继续编辑

#### 2.2 工作流审核机制
- **自动审核**：文件格式、内容安全检查
- **人工审核**：管理员审核工作流质量和合规性
- **审核状态**：待审核、已通过、已拒绝、已下架
- **审核反馈**：提供审核意见和修改建议

#### 2.3 工作流分类与标签
- **多级分类**：
  - 办公自动化（Excel处理、文档生成、邮件自动化）
  - 数据处理（数据清洗、数据分析、报表生成）
  - 设计创作（图像处理、视频编辑、UI设计）
  - 营销推广（社媒管理、广告投放、数据分析）
  - 开发工具（代码生成、测试自动化、部署脚本）
- **标签系统**：支持自定义标签，热门标签推荐
- **分类管理**：管理员可管理分类层级和权重

#### 2.4 工作流搜索与推荐
- **搜索功能**：
  - 关键词搜索（标题、描述、标签）
  - 分类筛选
  - 价格区间筛选
  - 评分筛选
  - 排序选项（最新、热门、评分、价格）
- **推荐算法**：
  - 基于用户行为的协同过滤
  - 基于内容的推荐
  - 热度排行推荐
  - 个性化推荐

### 3. 交易与支付系统

#### 3.1 支付集成
- **支付方式**：
  - paypal
  - 银行卡支付
  - 平台余额支付
- **充值功能**：多种金额选项，支持自定义金额
- **支付安全**：SSL加密、支付密码、风控系统

#### 3.2 交易管理
- **订单系统**：订单生成、状态跟踪、订单历史
- **退款机制**：支持特定条件下的退款申请
- **发票管理**：支持电子发票开具
- **交易记录**：详细的交易流水和统计

#### 3.3 收益分成系统
- **分成比例**：
  - 创作者：70%
  - 平台：30%
- **结算周期**：每月结算一次
- **提现功能**：支持银行卡提现，最低提现金额限制
- **收益统计**：实时收益查看，历史收益报表

### 4. 评价与社区系统

#### 4.1 评价系统
- **评分机制**：5星评分制
- **评价内容**：文字评价、使用体验分享
- **评价展示**：评价列表、评分统计、评价筛选
- **评价管理**：举报恶意评价、管理员审核

#### 4.2 收藏与关注
- **工作流收藏**：用户可收藏感兴趣的工作流
- **创作者关注**：关注优秀创作者，获取更新通知
- **收藏管理**：收藏列表管理、分类整理

#### 4.3 热度计算算法
```
热度分数 = 下载次数 × 0.4 + 用户评分 × 0.25 + 收藏数 × 0.2 + 评论数 × 0.1 + 时间衰减因子 × 0.05
```

### 5. 广告系统

#### 5.1 广告投放管理
- **广告位置**：
  - 首页横幅广告
  - 侧边栏广告
  - 工作流详情页广告
  - 搜索结果页广告
- **投放设置**：预算设置、投放时间、目标受众
- **素材管理**：广告图片、文案、链接管理

#### 5.2 广告效果统计
- **展示数据**：展示次数、展示率
- **点击数据**：点击次数、点击率
- **转化数据**：转化次数、转化率
- **费用统计**：消费金额、平均点击成本

### 6. 管理后台系统

#### 6.1 用户管理
- **用户列表**：用户信息查看、搜索、筛选
- **用户详情**：详细信息、交易记录、行为分析
- **用户操作**：账户冻结/解冻、余额调整、密码重置
- **权限管理**：角色权限分配、特殊权限设置

#### 6.2 内容管理
- **工作流审核**：待审核列表、审核操作、审核记录
- **内容监控**：违规内容检测、举报处理
- **推荐管理**：首页推荐、分类推荐设置
- **分类管理**：分类增删改、排序设置

#### 6.3 财务管理
- **收入统计**：平台总收入、分类收入、趋势分析
- **支出管理**：创作者分成、运营成本统计
- **财务报表**：月度报表、年度报表、自定义报表
- **结算管理**：创作者结算、广告商结算

#### 6.4 系统监控
- **运营数据**：用户增长、活跃度、留存率
- **性能监控**：服务器性能、数据库性能、API响应时间
- **错误监控**：系统错误、用户反馈、异常告警
- **日志管理**：操作日志、访问日志、错误日志

## API接口设计

### RESTful API 规范

#### 认证相关接口
```
POST   /api/auth/register       # 用户注册
POST   /api/auth/login          # 用户登录
POST   /api/auth/logout         # 用户登出
POST   /api/auth/refresh        # 刷新Token
POST   /api/auth/forgot-password # 忘记密码
POST   /api/auth/reset-password  # 重置密码
```

#### 用户相关接口
```
GET    /api/user/profile        # 获取用户信息
PUT    /api/user/profile        # 更新用户信息
POST   /api/user/avatar         # 上传头像
GET    /api/user/balance        # 获取账户余额
GET    /api/user/transactions   # 获取交易记录
POST   /api/user/recharge       # 账户充值
POST   /api/user/withdraw       # 申请提现
```

#### 工作流相关接口
```
GET    /api/workflows           # 获取工作流列表
GET    /api/workflows/:id       # 获取工作流详情
POST   /api/workflows           # 创建工作流
PUT    /api/workflows/:id       # 更新工作流
DELETE /api/workflows/:id       # 删除工作流
POST   /api/workflows/:id/purchase # 购买工作流
POST   /api/workflows/:id/favorite # 收藏工作流
POST   /api/workflows/:id/review   # 评价工作流
GET    /api/workflows/:id/reviews  # 获取工作流评价
```

#### 分类相关接口
```
GET    /api/categories          # 获取分类列表
GET    /api/categories/:id      # 获取分类详情
GET    /api/categories/:id/workflows # 获取分类下的工作流
```

#### 搜索相关接口
```
GET    /api/search/workflows    # 搜索工作流
GET    /api/search/suggestions  # 获取搜索建议
GET    /api/search/hot-keywords # 获取热门搜索词
```

#### 管理员接口
```
GET    /api/admin/users         # 获取用户列表
GET    /api/admin/users/:id     # 获取用户详情
PUT    /api/admin/users/:id     # 更新用户信息
POST   /api/admin/users/:id/reset-password # 重置用户密码
GET    /api/admin/workflows     # 获取工作流列表
PUT    /api/admin/workflows/:id/status # 更新工作流状态
GET    /api/admin/statistics    # 获取平台统计数据
GET    /api/admin/logs          # 获取操作日志
```

### API响应格式

#### 成功响应
```json
{
  "code": 200,
  "message": "success",
  "data": {
    // 具体数据
  },
  "timestamp": "2024-01-01T00:00:00Z"
}
```

#### 错误响应
```json
{
  "code": 400,
  "message": "参数错误",
  "error": {
    "field": "username",
    "reason": "用户名已存在"
  },
  "timestamp": "2024-01-01T00:00:00Z"
}
```

#### 分页响应
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "items": [],
    "pagination": {
      "current": 1,
      "pageSize": 20,
      "total": 100,
      "totalPages": 5
    }
  },
  "timestamp": "2024-01-01T00:00:00Z"
}
```

## 安全设计

### 1. 身份认证与授权
- **JWT Token**：使用JWT进行用户身份验证
- **Token刷新**：实现Token自动刷新机制
- **权限控制**：基于角色的访问控制（RBAC）
- **API限流**：防止API滥用，实现请求频率限制

### 2. 数据安全
- **数据加密**：敏感数据加密存储（密码、支付信息）
- **HTTPS传输**：全站HTTPS加密传输
- **SQL注入防护**：使用参数化查询，ORM框架防护
- **XSS防护**：输入验证、输出编码、CSP策略
- **CSRF防护**：CSRF Token验证

### 3. 文件安全
- **文件类型验证**：严格验证上传文件类型
- **文件大小限制**：限制上传文件大小
- **病毒扫描**：上传文件病毒扫描
- **文件隔离**：上传文件与应用程序隔离存储

### 4. 系统安全
- **防火墙配置**：WAF防火墙、DDoS防护
- **入侵检测**：实时监控异常行为
- **安全审计**：定期安全扫描和渗透测试
- **备份策略**：数据定期备份，灾难恢复方案

### 5. 业务安全
- **支付安全**：支付密码、风控系统、异常交易监控
- **防刷机制**：防止恶意刷量、刷评价
- **内容审核**：AI+人工审核，防止违规内容
- **反作弊**：检测和防止各种作弊行为

## 性能优化

### 1. 前端优化
- **代码分割**：按路由和组件进行代码分割
- **懒加载**：图片懒加载、组件懒加载
- **缓存策略**：浏览器缓存、CDN缓存
- **资源压缩**：CSS、JS、图片压缩
- **首屏优化**：关键资源优先加载

### 2. 后端优化
- **数据库优化**：
  - 索引优化
  - 查询优化
  - 连接池配置
  - 读写分离
- **缓存策略**：
  - Redis缓存热点数据
  - 查询结果缓存
  - 页面缓存
- **API优化**：
  - 响应压缩
  - 批量操作
  - 异步处理

### 3. 系统架构优化
- **负载均衡**：多服务器负载均衡
- **CDN加速**：静态资源CDN分发
- **微服务架构**：服务拆分，独立部署
- **消息队列**：异步任务处理

## 测试策略

### 1. 前端测试
- **单元测试**：Jest + React Testing Library
- **组件测试**：组件功能和交互测试
- **集成测试**：页面流程测试
- **E2E测试**：Cypress端到端测试
- **性能测试**：Lighthouse性能测试

### 2. 后端测试
- **单元测试**：Jest/Mocha + Chai
- **集成测试**：API接口测试
- **数据库测试**：数据库操作测试
- **性能测试**：压力测试、负载测试
- **安全测试**：安全漏洞扫描

### 3. 测试环境
- **开发环境**：本地开发测试
- **测试环境**：功能测试环境
- **预发布环境**：生产环境模拟
- **生产环境**：线上环境监控

## 部署方案

### 1. 环境配置
- **开发环境**：本地Docker容器
- **测试环境**：云服务器部署
- **生产环境**：集群部署，高可用配置

### 2. CI/CD流程
- **代码提交**：Git版本控制
- **自动构建**：Jenkins/GitHub Actions
- **自动测试**：单元测试、集成测试
- **自动部署**：Docker容器化部署
- **监控告警**：部署状态监控

### 3. 容器化部署
- **Docker镜像**：应用容器化
- **Docker Compose**：本地开发环境
- **Kubernetes**：生产环境容器编排
- **服务发现**：自动服务发现和负载均衡

## 监控与运维

### 1. 系统监控
- **服务器监控**：CPU、内存、磁盘、网络
- **应用监控**：应用性能、错误率、响应时间
- **数据库监控**：连接数、查询性能、慢查询
- **业务监控**：用户行为、交易数据、收入统计

### 2. 日志管理
- **日志收集**：ELK Stack（Elasticsearch + Logstash + Kibana）
- **日志分类**：访问日志、错误日志、业务日志
- **日志分析**：实时日志分析和告警
- **日志存储**：日志归档和清理策略

### 3. 告警机制
- **阈值告警**：性能指标超过阈值告警
- **异常告警**：系统异常、错误率告警
- **业务告警**：业务指标异常告警
- **告警通知**：邮件、短信、钉钉等多渠道通知

## 项目计划

### 第一阶段：基础功能开发（8周）
- **Week 1-2**：项目初始化、环境搭建、数据库设计
- **Week 3-4**：用户系统、认证授权、基础API
- **Week 5-6**：工作流上传、管理、基础展示
- **Week 7-8**：支付系统、交易管理、基础测试

### 第二阶段：核心功能完善（6周）
- **Week 9-10**：搜索系统、分类管理、推荐算法
- **Week 11-12**：评价系统、收藏功能、社区功能
- **Week 13-14**：管理后台、内容审核、数据统计

### 第三阶段：高级功能与优化（4周）
- **Week 15-16**：广告系统、收益分成、财务管理
- **Week 17-18**：性能优化、安全加固、压力测试

### 第四阶段：上线准备（2周）
- **Week 19**：生产环境部署、监控配置
- **Week 20**：最终测试、文档完善、上线发布

## 风险评估与应对

### 技术风险
- **风险**：技术选型不当，性能不达标
- **应对**：技术预研，性能测试，备选方案

### 安全风险
- **风险**：数据泄露，支付安全问题
- **应对**：安全审计，渗透测试，安全培训

### 业务风险
- **风险**：用户增长缓慢，内容质量不高
- **应对**：运营策略，激励机制，质量控制

### 运营风险
- **风险**：服务器宕机，数据丢失
- **应对**：高可用架构，数据备份，灾难恢复

## 成功指标

### 技术指标
- **性能指标**：页面加载时间 < 2秒，API响应时间 < 500ms
- **可用性指标**：系统可用性 > 99.9%
- **安全指标**：无重大安全事故

### 业务指标
- **用户指标**：注册用户数、活跃用户数、用户留存率
- **内容指标**：工作流数量、下载次数、评分分布
- **收入指标**：平台收入、创作者收入、广告收入

### 质量指标
- **代码质量**：代码覆盖率 > 80%，代码规范检查通过
- **用户体验**：用户满意度 > 4.0分（5分制）
- **运维质量**：故障恢复时间 < 30分钟

## 总结

本项目需求书详细描述了工作流分享平台的技术架构、功能需求、安全设计、性能优化等各个方面。项目采用现代化的技术栈，注重安全性和可扩展性，通过分阶段开发确保项目按时交付。

开发团队需要严格按照需求书执行，定期进行技术评审和风险评估，确保项目质量和进度。同时，需要与产品、运营、测试等团队密切配合，共同推进项目成功上线。